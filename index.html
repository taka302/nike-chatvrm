<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nike ChatVRM Enhanced - å®Œå…¨ç‰ˆ</title>

    <!-- â˜… ãƒ‡ã‚¶ã‚¤ãƒ³ç”¨ CSS ã‚’èª­ã¿è¾¼ã‚€ â˜… -->
    <link rel="stylesheet" href="style.css">

    <!-- Mermaid.js - ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã€å›³è¡¨ -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

    <!-- Chart.js - ã‚°ãƒ©ãƒ• -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- MathJax - æ•°å¼ -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Marked.js - Markdownè§£æ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Three.js 3Dè¡¨ç¤º -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>

    <!-- VRM Loader - VRoidãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ï¼ˆä¿®æ­£ç‰ˆï¼‰ -->
    <script type="module">
        // Three.jsãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã®ã‚’å¾…ã¤
        window.addEventListener('load', async () => {
            try {
                // å‹•çš„ã«ES Moduleã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                const { GLTFLoader } = await import('https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/loaders/GLTFLoader.js');
                const { VRMLoaderPlugin } = await import('https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@2.0.0/lib/three-vrm.module.js');

                window.GLTFLoader = GLTFLoader;
                window.VRMLoaderPlugin = VRMLoaderPlugin;
                window.VRM = (await import('https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@2.0.0/lib/three-vrm.module.js')).VRM;
            } catch (error) {
                console.error('VRMãƒ­ãƒ¼ãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼', error);
                const target = document.getElementById('vrm-error');
                if (target) {
                    target.textContent = 'VRMãƒ­ãƒ¼ãƒ€ãƒ¼ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿ã—ã¦ãã ã•ã„ã€‚';
                }
            }
        });
    </script>
</head>
<body>
  ãƒ†ã‚¹ãƒˆï¼šã“ã®è¡ŒãŒè¦‹ãˆãŸã‚‰ index.html ã¯åæ˜ ã•ã‚Œã¦ã„ã¾ã™
  <!-- ã“ã“ã‹ã‚‰æœ¬æ¥ã®ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ -->
  <div class="container">
      <!-- å·¦ 25%ï¼šVRMã‚­ãƒ£ãƒ³ãƒã‚¹ -->
      <aside class="character-panel">
          <div class="character-display">
              <canvas id="vrm-canvas" class="vrm-canvas"></canvas>
              <div class="character-name" id="character-name">ãƒ‹ã‚±ã¡ã‚ƒã‚“</div>
          </div>

          <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ -->
          <div class="input-panel-section">
              <label for="character-select">ğŸ­ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠï¼š</label>
              <select id="character-select" onchange="changeCharacter(event)">
                  <option value="nike">ãƒ‹ã‚±ã¡ã‚ƒã‚“</option>
                  <option value="friendly">ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼</option>
                  <option value="professional">ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«</option>
              </select>
          </div>

          <!-- VOICEVOX å‡ºåŠ›è¨­å®šï¼ˆç°¡æ˜“ï¼‰ -->
          <div class="input-panel-section">
              <label for="voicevox-character">ğŸ”Š VOICEVOXã‚­ãƒ£ãƒ©ï¼š</label>
              <select id="voicevox-character">
                  <option value="3">ãšã‚“ã ã‚‚ã‚“</option>
                  <option value="2">å››å›½ã‚ãŸã‚“</option>
                  <option value="8">æ˜¥æ—¥éƒ¨ã¤ã‚€ã</option>
                  <option value="67">ãƒŠãƒ¼ã‚¹ãƒ­ãƒœ_ã‚¿ã‚¤ãƒ—T</option>
              </select>
          </div>

          <!-- VRMãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ -->
          <div class="input-panel-section">
              <label for="vrm-file-input">ğŸ“‚ VRMãƒ•ã‚¡ã‚¤ãƒ«ï¼š</label>
              <input type="file" id="vrm-file-input" accept=".vrm" onchange="loadVRMFile(event)">
          </div>
      </aside>

      <!-- ä¸­å¤® 50%ï¼šãƒãƒ£ãƒƒãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
      <main class="chat-panel">
          <div id="chat-messages" class="chat-messages">
              <!-- script.js ã® displayWelcomeMessage ãŒã“ã“ã‚’æ›¸ãæ›ãˆã¾ã™ -->
          </div>
      </main>

      <!-- å³ 25%ï¼šå…¥åŠ›ã‚¨ãƒªã‚¢ï¼ˆæ–°è¨­ï¼‰ -->
      <aside class="input-panel">
          <div class="panel-header">
              <h3>ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å…¥åŠ›</h3>
              <button id="settings-btn" class="settings-btn">âš™ï¸ è¨­å®š</button>
          </div>

          <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰é–¢é€£ -->
          <div id="drop-zone" class="drop-zone">
              <p>ğŸ“· ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</p>
              <input type="file" id="image-file-input" accept="image/*" multiple style="display:none">
          </div>

          <div id="image-preview-area" class="image-preview-area" style="display:none;">
              <div class="image-preview-header">
                  <span>é¸æŠä¸­ã®ç”»åƒ</span>
                  <button id="clear-images-btn" class="clear-images-btn">ã™ã¹ã¦å‰Šé™¤</button>
              </div>
              <div id="image-preview-grid" class="image-preview-grid"></div>
          </div>

          <!-- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›æ¬„ -->
          <textarea id="user-input"
              placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...ï¼ˆç”»åƒã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ä¸Šã®æ ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼‰"></textarea>

          <!-- ãƒœã‚¿ãƒ³ç¾¤ -->
          <div class="button-group">
              <button id="send-btn" class="send-btn">ğŸ“¨ é€ä¿¡</button>
              <button id="image-btn" class="image-btn">ğŸ–¼ ç”»åƒè¿½åŠ </button>
          </div>
          <div class="button-group">
              <button id="voice-btn" class="voice-btn">ğŸ¤ éŸ³å£°å…¥åŠ›</button>
              <button id="stop-voice-btn" class="stop-voice-btn" style="display:none;">â¹ åœæ­¢</button>
          </div>
      </aside>
  </div>

  <!-- ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ç”¨ã®éš ã—inputï¼ˆå¿µã®ãŸã‚ï¼‰ -->
  <input type="file" id="hidden-image-input" accept="image/*" multiple style="display:none">

  <script src="script.js"></script>
</body>
</html>
