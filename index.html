<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nike ChatVRM Enhanced - å®Œå…¨ç‰ˆ</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- ğŸ“Š Mermaid.js - ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã€å›³è¡¨ -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <!-- ğŸ“ˆ Chart.js - ã‚°ãƒ©ãƒ• -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- ğŸ”¢ MathJax - æ•°å¼ -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- âœ¨ Marked.js - Markdownè§£æ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- ğŸ® Three.js - 3Dè¡¨ç¤º -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
    
    <!-- ğŸ§ VRM Loader - VRoidãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ï¼ˆä¿®æ­£ç‰ˆ2 - ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼‰ -->
    <script>
        // Three.jsãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã®ã‚’å¾…ã¤
        window.addEventListener('load', async () => {
            try {
                // å‹•çš„ã«ES Moduleã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                const { GLTFLoader } = await import('https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/loaders/GLTFLoader.js');
                const { VRMLoaderPlugin } = await import('https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@2.0.6/lib/three-vrm.module.js');
                
                window.GLTFLoader = GLTFLoader;
                window.VRMLoaderPlugin = VRMLoaderPlugin;
                
                window.dispatchEvent(new Event('vrm-loaders-ready'));
                console.log('âœ… VRMãƒ­ãƒ¼ãƒ€ãƒ¼èª­ã¿è¾¼ã¿å®Œäº†');
            } catch (error) {
                console.error('âŒ VRMãƒ­ãƒ¼ãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- å·¦å´ï¼šã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼ãƒ‘ãƒãƒ« -->
        <div class="character-panel">
            <div class="character-display">
                <!-- ğŸ® 3D VRMã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
                <canvas id="vrm-canvas" class="vrm-canvas"></canvas>
                
                <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼å -->
                <div class="character-name" id="character-name">ãƒ‹ã‚±ã¡ã‚ƒã‚“</div>
            </div>
            
            <!-- ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠ -->
            <div class="character-selector">
                <label>ğŸ­ ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼é¸æŠï¼š</label>
                <select id="character-select">
                    <option value="nike">ãƒ‹ã‚±ã¡ã‚ƒã‚“</option>
                    <option value="friendly">ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼</option>
                    <option value="professional">ãƒ—ãƒ­ãƒ•ã‚§ãƒƒã‚·ãƒ§ãƒŠãƒ«</option>
                </select>
            </div>
            
            <!-- ğŸ® VRMãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ -->
            <div class="vrm-upload">
                <label class="vrm-upload-btn">
                    ğŸ“‚ VRMãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚€
                    <input type="file" id="vrm-file-input" accept=".vrm" style="display: none;">
                </label>
            </div>
            
            <!-- ğŸ¤ éŸ³å£°è¨­å®š -->
            <div class="voice-settings">
                <label>ğŸ”Š éŸ³å£°å‡ºåŠ›ï¼š</label>
                <select id="voice-select">
                    <option value="voicevox">VOICEVOXï¼ˆé«˜å“è³ªï¼‰</option>
                    <option value="browser">ãƒ–ãƒ©ã‚¦ã‚¶æ¨™æº–</option>
                    <option value="off">ã‚ªãƒ•</option>
                </select>
                
                <label style="margin-top: 10px;">ğŸ­ VOICEVOXã‚­ãƒ£ãƒ©ï¼š</label>
                <select id="voicevox-character">
                    <option value="3">ãšã‚“ã ã‚‚ã‚“ï¼ˆãƒãƒ¼ãƒãƒ«ï¼‰</option>
                    <option value="1">å››å›½ã‚ãŸã‚“ï¼ˆãƒãƒ¼ãƒãƒ«ï¼‰</option>
                    <option value="8">æ˜¥æ—¥éƒ¨ã¤ã‚€ãï¼ˆãƒãƒ¼ãƒãƒ«ï¼‰</option>
                    <option value="2">å››å›½ã‚ãŸã‚“ï¼ˆã‚ã¾ã‚ã¾ï¼‰</option>
                    <option value="0">å››å›½ã‚ãŸã‚“ï¼ˆãƒãƒ¼ãƒãƒ«ï¼‰</option>
                </select>
            </div>
        </div>

        <!-- ä¸­å¤®ï¼šãƒãƒ£ãƒƒãƒˆã‚¨ãƒªã‚¢ -->
        <div class="chat-panel">
            <div class="chat-messages" id="chat-messages">
                <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>

            <!-- ğŸ“¸ ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <div class="image-preview-area" id="image-preview-area" style="display: none;">
                <div class="image-preview-header">
                    <span>ğŸ“¸ æ·»ä»˜ç”»åƒ</span>
                    <button class="clear-images-btn" id="clear-images-btn">ğŸ—‘ï¸ ã™ã¹ã¦å‰Šé™¤</button>
                </div>
                <div class="image-preview-grid" id="image-preview-grid">
                    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
            </div>

            <!-- å…¥åŠ›ã‚¨ãƒªã‚¢ -->
            <div class="input-area">
                <!-- ğŸ“¸ ç”»åƒãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ -->
                <div class="drop-zone" id="drop-zone">
                    <p>ğŸ“¸ ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</p>
                </div>
                
                <textarea id="user-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...ï¼ˆç”»åƒã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ä¸Šã®æ ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼‰"></textarea>
                
                <div class="button-group">
                    <button id="send-btn" class="send-btn">ğŸ“¤ é€ä¿¡</button>
                    <button id="image-btn" class="image-btn">ğŸ“· ç”»åƒè¿½åŠ </button>
                    <button id="voice-btn" class="voice-btn">ğŸ¤ éŸ³å£°å…¥åŠ›</button>
                    <button id="stop-voice-btn" class="stop-voice-btn" style="display:none;">â¹ï¸ åœæ­¢</button>
                </div>
                
                <!-- éš ã—ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ› -->
                <input type="file" id="image-file-input" accept="image/*" multiple style="display: none;">
            </div>
        </div>

        <!-- å³å´ï¼šé–¢é€£ãƒ¡ãƒ‡ã‚£ã‚¢ -->
        <div class="media-panel">
            <div class="panel-header">
                <h3>ğŸ“¸ é–¢é€£ãƒ¡ãƒ‡ã‚£ã‚¢</h3>
                <button class="settings-btn" id="settings-btn">âš™ï¸ è¨­å®š</button>
            </div>
            <div class="media-grid" id="media-grid">
                <!-- ç”»åƒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
    <script>
        // MermaidåˆæœŸåŒ–ï¼ˆä¿®æ­£ç‰ˆ - æ‰‹å‹•åˆ¶å¾¡ã«å¤‰æ›´ï¼‰
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Arial, sans-serif'
        });
        console.log('âœ… MermaidåˆæœŸåŒ–å®Œäº†');
    </script>
</body>
</html>
