<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nike ChatVRM Enhanced - å®Œå…¨ç‰ˆ</title>
    <link rel="stylesheet" href="style.css">
    
    <!-- ğŸ“Š Mermaid.js - ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã€å›³è¡¨ -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <!-- ğŸ“ˆ Chart.js - ã‚°ãƒ©ãƒ• -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <!-- ğŸ”¢ MathJax - æ•°å¼ -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- âœ¨ Marked.js - Markdownè§£æ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- ğŸ® Three.js - 3Dè¡¨ç¤º -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
    
    <!-- ğŸ§ VRM Loader - VRoidãƒ¢ãƒ‡ãƒ«èª­ã¿è¾¼ã¿ï¼ˆä¿®æ­£ç‰ˆ2 - ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å¯¾å¿œï¼‰ -->
    <script>
        // Three.jsãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã®ã‚’å¾…ã¤
        window.addEventListener('load', async () => {
            try {
                // å‹•çš„ã«ES Moduleã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
                const { GLTFLoader } = await import('https://cdn.jsdelivr.net/npm/three@0.155.0/examples/jsm/loaders/GLTFLoader.js');
                const { VRMLoaderPlugin } = await import('https://cdn.jsdelivr.net/npm/@pixiv/three-vrm@2.0.6/lib/three-vrm.module.js');
                
                window.GLTFLoader = GLTFLoader;
                window.VRMLoaderPlugin = VRMLoaderPlugin;
                
                window.dispatchEvent(new Event('vrm-loaders-ready'));
                console.log('âœ… VRMãƒ­ãƒ¼ãƒ€ãƒ¼èª­ã¿è¾¼ã¿å®Œäº†');
            } catch (error) {
                console.error('âŒ VRMãƒ­ãƒ¼ãƒ€ãƒ¼èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- å·¦å´ï¼šVRMå…¨ç”»é¢è¡¨ç¤ºãƒ‘ãƒãƒ« -->
        <div class="character-panel">
            <!-- ğŸ® 3D VRMã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
            <canvas id="vrm-canvas" class="vrm-canvas"></canvas>
        </div>

        <!-- ä¸­å¤®ï¼šå—ä¿¡ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ãƒãƒ« -->
        <div class="chat-panel">
            <div class="panel-header">
                <h3>ğŸ’¬ ãƒãƒ£ãƒƒãƒˆ</h3>
                <button class="settings-btn" id="settings-btn">âš™ï¸ è¨­å®š</button>
            </div>
            <div class="chat-messages" id="chat-messages">
                <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>

        <!-- å³å´ï¼šå…¥åŠ›ãƒ‘ãƒãƒ« -->
        <div class="input-panel">
            <!-- ğŸ“¸ ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚¨ãƒªã‚¢ -->
            <div class="image-preview-area" id="image-preview-area" style="display: none;">
                <div class="image-preview-header">
                    <span>ğŸ“¸ æ·»ä»˜ç”»åƒ</span>
                    <button class="clear-images-btn" id="clear-images-btn">ğŸ—‘ï¸ ã™ã¹ã¦å‰Šé™¤</button>
                </div>
                <div class="image-preview-grid" id="image-preview-grid">
                    <!-- ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”»åƒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
            </div>

            <!-- ğŸ“¸ ç”»åƒãƒ‰ãƒ­ãƒƒãƒ—ã‚¾ãƒ¼ãƒ³ -->
            <div class="drop-zone" id="drop-zone">
                <p>ğŸ“¸ ç”»åƒã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã€ã¾ãŸã¯ã‚¯ãƒªãƒƒã‚¯ã—ã¦é¸æŠ</p>
            </div>
            
            <!-- ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ã‚¨ãƒªã‚¢ -->
            <textarea id="user-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›...ï¼ˆç”»åƒã‚’è¿½åŠ ã™ã‚‹å ´åˆã¯ä¸Šã®æ ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼‰"></textarea>
            
            <!-- ãƒœã‚¿ãƒ³ã‚°ãƒ«ãƒ¼ãƒ— -->
            <div class="button-group">
                <button id="send-btn" class="send-btn">ğŸ“¤ é€ä¿¡</button>
                <button id="image-btn" class="image-btn">ğŸ“· ç”»åƒè¿½åŠ </button>
                <button id="voice-btn" class="voice-btn">ğŸ¤ éŸ³å£°å…¥åŠ›</button>
                <button id="stop-voice-btn" class="stop-voice-btn" style="display:none;">â¹ï¸ åœæ­¢</button>
            </div>
            
            <!-- éš ã—ãƒ•ã‚¡ã‚¤ãƒ«å…¥åŠ› -->
            <input type="file" id="image-file-input" accept="image/*" multiple style="display: none;">
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
    <script>
        // MermaidåˆæœŸåŒ–ï¼ˆä¿®æ­£ç‰ˆ - æ‰‹å‹•åˆ¶å¾¡ã«å¤‰æ›´ï¼‰
        mermaid.initialize({ 
            startOnLoad: false,
            theme: 'default',
            securityLevel: 'loose',
            fontFamily: 'Arial, sans-serif'
        });
        console.log('âœ… MermaidåˆæœŸåŒ–å®Œäº†');
    </script>
</body>
</html>
